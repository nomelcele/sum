<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="mail">
<!--   	<insert id="addMail" parameterType="map"> -->
<!--   		insert into mail values(mail_seq.nextVal,?,?,?,?,?,sysdate,1,1) -->
<!--   	</insert> -->
	<select id="getFromMailList" parameterType="map" resultType="mavo">
		select * from (select rownum r_num, a.* from 
		(select ma.mailnum, me.memname, ma.mailtitle, ma.maildate 
		from member me, mail ma where me.memnum=ma.mailmem and ma.mailreceiver=#{userid} 
		and ma.mailrdelete=1 and not ma.mailmem=#{usernum} order by ma.maildate desc) a)
		where r_num between #{begin} and #{end}
	</select>
	<select id="getToMailList" parameterType="map" resultType="mavo">
		select * from (select rownum r_num, a.* from 
		(select ma.mailnum, me.memname, ma.mailtitle, ma.maildate 
		from member me, mail ma where me.meminmail=ma.mailreceiver and ma.mailmem=#{usernum} 
		and ma.mailsdelete=1 and not ma.mailreceiver=#{userid} order by ma.maildate desc) a)
		where r_num between #{begin} and #{end}
	</select>
	<select id="getMyMailList" parameterType="map" resultType="mavo">
		select * from (select rownum r_num, a.* from 
		(select ma.mailnum, ma.mailtitle, ma.maildate, me.memname 
		from member me, mail ma where me.memnum=ma.mailmem and ma.mailmem=#{usernum} 
		and ma.mailreceiver=#{userid} and ma.mailsdelete=1 and ma.mailrdelete=1 order by ma.maildate desc) a) 
		where r_num between #{begin} and #{end}
	</select>
	<select id="getTrashList" parameterType="map" resultType="mavo">
		select * from (select rownum r_num, a.* from 
		(select ma.mailnum, me1.memname mailsname, me2.memname mailrname, ma.mailtitle, ma.maildate 
		from member me1, member me2, mail ma 
		where (me1.memnum=ma.mailmem and me2.meminmail=ma.mailreceiver) and 
		((ma.mailmem=#{usernum} and ma.mailsdelete=2) or (ma.mailreceiver=#{userid} and ma.mailrdelete=2)) 
		order by ma.maildate desc) a) where r_num between #{begin} and #{end}
	</select>
	<select id="getMailDetail" parameterType="int" resultType="mavo">
		select ma.mailtitle, me1.memname mailsname, me2.memname mailrname, ma.maildate, 
		ma.mailcont, ma.mailfile, me1.meminmail replyid, ma.mailreceiver 
		from mail ma, member me1, member me2 
		where me1.memnum=ma.mailmem and me2.meminmail=ma.mailreceiver and ma.mailnum=#{mailnum}
	</select>
	<select id="" parameterType="int" resultType="mavo">
		select mailmem,mailreceiver from mail where mailnum=#{num}
	</select>
<!-- 	<update id="" parameterType=""> -->
<!-- 		update mail set mailsdelete=? where mailnum=? -->
<!-- 	</update> -->
<!-- 	<update id=""> -->
<!-- 		update mail set mailrdelete=? where mailnum=? -->
<!-- 	</update> -->
  </mapper>